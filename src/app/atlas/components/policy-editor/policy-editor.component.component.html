    <div class="policy-editor">
      <header class="page-header">
        <h1>Hedge Policies</h1>
        <button class="btn btn-primary" (click)="showCreateModal = true">+ New Policy</button>
      </header>

      <!-- Policies List -->
      <section class="policies-list">
        <div class="policy-card" *ngFor="let policy of policies" [class.default]="policy.is_default">
          <div class="policy-header">
            <h3>{{ policy.name }}</h3>
            <span class="default-badge" *ngIf="policy.is_default">Default</span>
          </div>
          <p class="policy-description">{{ policy.description || 'No description' }}</p>

          <div class="coverage-rules">
            <h4>Coverage Rules</h4>
            <div class="rules-grid">
              <div class="rule" *ngFor="let rule of getHorizons(policy.coverage_rules)">
                <span class="horizon">{{ rule.horizon }}</span>
                <span class="target">{{ rule.target }}%</span>
              </div>
            </div>
          </div>

          <div class="policy-meta">
            <span *ngIf="policy.exposure_type">Type: {{ policy.exposure_type }}</span>
            <span>Currency: {{ policy.currency }}</span>
            <span *ngIf="policy.min_amount">Min: {{ policy.min_amount | number }}</span>
          </div>

          <div class="policy-actions">
            <button class="btn btn-sm" (click)="simulatePolicy(policy)">Simulate</button>
            <button class="btn btn-sm" (click)="editPolicy(policy)">Edit</button>
            <button class="btn btn-sm" (click)="setAsDefault(policy)" *ngIf="!policy.is_default">Set Default</button>
          </div>
        </div>

        <div class="empty-state" *ngIf="policies.length === 0 && !loading">
          <p>No policies configured. Create your first policy to start generating recommendations.</p>
        </div>
      </section>

      <!-- Simulation Result -->
      <section class="simulation-result" *ngIf="simulationResult">
        <h2>Policy Simulation Result</h2>
        <div class="sim-metrics">
          <div class="metric">
            <span class="label">Total Exposure</span>
            <span class="value">{{ simulationResult.total_exposure | number:'1.0-0' }}</span>
          </div>
          <div class="metric">
            <span class="label">Would Hedge</span>
            <span class="value">{{ simulationResult.would_hedge | number:'1.0-0' }}</span>
          </div>
          <div class="metric">
            <span class="label">Coverage %</span>
            <span class="value">{{ simulationResult.coverage_percentage | number:'1.1-1' }}%</span>
          </div>
          <div class="metric">
            <span class="label">Est. Orders</span>
            <span class="value">{{ simulationResult.estimated_orders }}</span>
          </div>
        </div>
        <button class="btn btn-secondary" (click)="simulationResult = null">Close</button>
      </section>

      <!-- Create/Edit Modal -->
      <div class="modal" *ngIf="showCreateModal" (click)="closeModal($event)">
        <div class="modal-content" (click)="$event.stopPropagation()">
          <h2>{{ editingPolicy ? 'Edit Policy' : 'New Policy' }}</h2>
          <form [formGroup]="policyForm" (ngSubmit)="savePolicy()">
            <div class="form-group">
              <label>Policy Name *</label>
              <input type="text" formControlName="name" placeholder="e.g., Standard Coverage">
            </div>

            <div class="form-group">
              <label>Description</label>
              <textarea formControlName="description" rows="2"></textarea>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Exposure Type</label>
                <select formControlName="exposure_type">
                  <option value="">All Types</option>
                  <option value="payable">Payables Only</option>
                  <option value="receivable">Receivables Only</option>
                </select>
              </div>
              <div class="form-group">
                <label>Currency</label>
                <select formControlName="currency">
                  <option value="USD">USD</option>
                  <option value="EUR">EUR</option>
                </select>
              </div>
            </div>

            <div class="form-group">
              <label>Coverage Rules by Horizon</label>
              <div class="rules-editor">
                <div class="rule-row" *ngFor="let h of horizonLabels">
                  <span class="horizon-label">{{ h.label }}</span>
                  <input type="number" [formControlName]="'rule_' + h.key"
                         min="0" max="100" step="5" placeholder="%">
                  <span class="percent">%</span>
                </div>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Min Amount to Apply</label>
                <input type="number" formControlName="min_amount" step="1000">
              </div>
              <div class="form-group">
                <label>Require Approval Above</label>
                <input type="number" formControlName="require_approval_above" step="10000">
              </div>
            </div>

            <div class="form-group checkbox-group">
              <label>
                <input type="checkbox" formControlName="auto_generate_recommendations">
                Auto-generate recommendations
              </label>
              <label>
                <input type="checkbox" formControlName="is_default">
                Set as default policy
              </label>
            </div>

            <div class="form-actions">
              <button type="button" class="btn btn-secondary" (click)="showCreateModal = false">Cancel</button>
              <button type="submit" class="btn btn-primary" [disabled]="!policyForm.valid">Save</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  
